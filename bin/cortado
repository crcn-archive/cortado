#!/usr/bin/env node

var commander = require("commander"),
cortado       = require(".."),
_             = require("underscore"),
path          = require("path")


commander.
option("--config [config_path]", "path to config (./.cortado.js)", "./.cortado.js").
option("--full", "run full integration test");


commander.
command("start").
description("run cortado server").
action(function() {

  var cfgs = [
    commander.config,
    process.env.HOME + "/.cortado.js"
  ], cfg = {};

  for(var i = cfgs.length; i--;) {
    try {
      cfg = _.extend(cfg, require(path.resolve(process.cwd(), cfgs[i])))
    } catch(e) {

    }
  }

  cortado.start(_.extend(cfg, {
    full: commander.full
  }))
});



commander.parse(process.argv);