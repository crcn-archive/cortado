// Generated by CoffeeScript 1.6.3
var fasten, fastener;

fasten = require("fasten");

fastener = fasten();

fastener.add("actions", {
  visit: {
    call: function(url, next) {
      var _this = this;
      return this.preview.location(url, function() {
        return next(null, _this);
      });
    }
  },
  type: {
    call: function(path, value, next) {
      var _this = this;
      return this.preview.findElements(path, function(err, $elements) {
        if (err != null) {
          return next(err);
        }
        $elements.val(value);
        $elements.trigger("keydown");
        $elements.trigger("keyup");
        return next(null, _this);
      });
    }
  },
  click: {
    call: function(path, next) {
      return this.preview.findElements(path, function(err, $elements) {
        if (err != null) {
          return next(err);
        }
        $elements.trigger("click");
        return next(null, this);
      });
    }
  },
  find: function(path, fn, next) {
    return this.preview.findElements(path, function(err, $elements) {
      var e;
      if (err != null) {
        return next(err);
      }
      try {
        fn($elements);
      } catch (_error) {
        e = _error;
        next(e, this);
      }
      return next(null, this);
    });
  },
  then: function(fn, next) {
    var e;
    try {
      fn();
    } catch (_error) {
      e = _error;
      return next(e);
    }
    return next();
  }
});

module.exports = function(preview) {
  return fastener.wrap("actions", {
    preview: preview
  });
};
